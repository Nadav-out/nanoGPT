
step 0: train loss 7.2224, val loss 7.2210
[2023-09-30 01:18:52,375] torch._inductor.utils: [WARNING] using triton random, expect difference from eager
[2023-09-30 01:18:52,623] torch._inductor.utils: [WARNING] using triton random, expect difference from eager
[2023-09-30 01:18:53,130] torch._inductor.utils: [WARNING] using triton random, expect difference from eager
[2023-09-30 01:18:53,357] torch._inductor.utils: [WARNING] using triton random, expect difference from eager
[2023-09-30 01:18:53,848] torch._inductor.utils: [WARNING] using triton random, expect difference from eager
[2023-09-30 01:18:54,068] torch._inductor.utils: [WARNING] using triton random, expect difference from eager
[2023-09-30 01:18:54,400] torch._inductor.utils: [WARNING] using triton random, expect difference from eager
[2023-09-30 01:18:54,620] torch._inductor.utils: [WARNING] using triton random, expect difference from eager
[2023-09-30 01:18:54,951] torch._inductor.utils: [WARNING] using triton random, expect difference from eager
[2023-09-30 01:18:55,170] torch._inductor.utils: [WARNING] using triton random, expect difference from eager
[2023-09-30 01:18:55,507] torch._inductor.utils: [WARNING] using triton random, expect difference from eager
[2023-09-30 01:18:55,763] torch._inductor.utils: [WARNING] using triton random, expect difference from eager
iter 0: loss 7.1736, time 16216.16ms, mfu -100.00%
iter 10: loss 5.3374, time 47.14ms, mfu 8.19%
iter 20: loss 3.9024, time 47.24ms, mfu 8.19%
iter 30: loss 3.2442, time 49.83ms, mfu 8.15%
iter 40: loss 2.9362, time 46.78ms, mfu 8.16%
iter 50: loss 2.7341, time 39.76ms, mfu 8.31%
iter 60: loss 2.6022, time 40.20ms, mfu 8.44%
iter 70: loss 2.5200, time 50.73ms, mfu 8.36%
iter 80: loss 2.5962, time 51.27ms, mfu 8.28%
iter 90: loss 2.5173, time 46.22ms, mfu 8.28%
iter 100: loss 2.3948, time 50.44ms, mfu 8.22%
iter 110: loss 2.3759, time 47.18ms, mfu 8.22%
iter 120: loss 2.3144, time 47.55ms, mfu 8.21%
iter 130: loss 2.3598, time 50.23ms, mfu 8.16%
iter 140: loss 2.2662, time 49.83ms, mfu 8.12%
iter 150: loss 2.2069, time 39.61ms, mfu 8.28%
iter 160: loss 2.1345, time 40.32ms, mfu 8.41%
iter 170: loss 2.0907, time 50.46ms, mfu 8.33%
iter 180: loss 2.0401, time 51.36ms, mfu 8.25%
iter 190: loss 2.0199, time 50.00ms, mfu 8.20%
iter 200: loss 2.0448, time 49.54ms, mfu 8.16%
iter 210: loss 2.0376, time 54.36ms, mfu 8.05%
iter 220: loss 1.9554, time 47.34ms, mfu 8.06%
iter 230: loss 1.9894, time 50.19ms, mfu 8.03%
iter 240: loss 1.9850, time 50.47ms, mfu 7.99%
step 250: train loss 1.8570, val loss 2.0606
saving checkpoint to perliment_out2
iter 250: loss 1.8644, time 7598.82ms, mfu 7.20%
iter 260: loss 1.9402, time 48.63ms, mfu 7.27%
iter 270: loss 1.9036, time 52.14ms, mfu 7.28%
iter 280: loss 1.8170, time 48.57ms, mfu 7.35%
iter 290: loss 1.9327, time 39.73ms, mfu 7.59%
iter 300: loss 1.7678, time 47.40ms, mfu 7.64%
iter 310: loss 1.8089, time 49.78ms, mfu 7.66%
iter 320: loss 1.8056, time 47.05ms, mfu 7.71%
iter 330: loss 1.8147, time 44.97ms, mfu 7.80%
iter 340: loss 1.7893, time 48.13ms, mfu 7.82%
iter 350: loss 1.7579, time 48.85ms, mfu 7.83%
iter 360: loss 1.6950, time 49.45ms, mfu 7.83%
iter 370: loss 1.7638, time 40.16ms, mfu 8.01%
iter 380: loss 1.6747, time 47.61ms, mfu 8.02%
iter 390: loss 1.7564, time 49.29ms, mfu 8.00%
iter 400: loss 1.7202, time 45.60ms, mfu 8.05%
iter 410: loss 1.6466, time 47.95ms, mfu 8.05%
iter 420: loss 1.6863, time 47.67ms, mfu 8.05%
iter 430: loss 1.6637, time 49.39ms, mfu 8.03%
iter 440: loss 1.6526, time 49.35ms, mfu 8.01%
iter 450: loss 1.6862, time 39.82ms, mfu 8.18%
iter 460: loss 1.6543, time 48.45ms, mfu 8.16%
iter 470: loss 1.6916, time 50.97ms, mfu 8.10%
iter 480: loss 1.6401, time 46.31ms, mfu 8.12%
iter 490: loss 1.5794, time 49.19ms, mfu 8.10%
step 500: train loss 1.5848, val loss 1.7637
saving checkpoint to perliment_out2
iter 500: loss 1.6224, time 5970.44ms, mfu 7.29%
iter 510: loss 1.5715, time 51.35ms, mfu 7.32%
iter 520: loss 1.5963, time 50.52ms, mfu 7.35%
iter 530: loss 1.5738, time 39.90ms, mfu 7.58%
iter 540: loss 1.5511, time 40.63ms, mfu 7.77%
iter 550: loss 1.5525, time 48.73ms, mfu 7.79%
iter 560: loss 1.7331, time 51.86ms, mfu 7.76%
iter 570: loss 1.6867, time 53.11ms, mfu 7.71%
iter 580: loss 1.6002, time 53.37ms, mfu 7.66%
iter 590: loss 1.6543, time 50.14ms, mfu 7.66%
iter 600: loss 1.5527, time 47.67ms, mfu 7.71%
iter 610: loss 1.5540, time 51.38ms, mfu 7.69%
iter 620: loss 1.6015, time 49.82ms, mfu 7.70%
iter 630: loss 1.5923, time 51.69ms, mfu 7.67%
iter 640: loss 1.5406, time 50.27ms, mfu 7.67%
iter 650: loss 1.6399, time 49.04ms, mfu 7.69%
iter 660: loss 1.6413, time 48.69ms, mfu 7.72%
iter 670: loss 1.5696, time 40.19ms, mfu 7.91%
iter 680: loss 1.5317, time 50.83ms, mfu 7.88%
iter 690: loss 1.5519, time 47.45ms, mfu 7.90%
iter 700: loss 1.5150, time 48.09ms, mfu 7.92%
iter 710: loss 1.5153, time 51.43ms, mfu 7.88%
iter 720: loss 1.5261, time 51.03ms, mfu 7.84%
iter 730: loss 1.5265, time 51.18ms, mfu 7.81%
iter 740: loss 1.4468, time 41.49ms, mfu 7.96%
step 750: train loss 1.5096, val loss 1.7055
saving checkpoint to perliment_out2
iter 750: loss 1.5797, time 5873.96ms, mfu 7.17%
iter 760: loss 1.5572, time 42.69ms, mfu 7.36%
iter 770: loss 1.5198, time 49.30ms, mfu 7.41%
iter 780: loss 1.5228, time 50.00ms, mfu 7.44%
iter 790: loss 1.6484, time 49.17ms, mfu 7.48%
iter 800: loss 1.6262, time 52.94ms, mfu 7.46%
iter 810: loss 1.4293, time 49.12ms, mfu 7.50%
iter 820: loss 1.5005, time 48.94ms, mfu 7.54%
iter 830: loss 1.5015, time 48.05ms, mfu 7.59%
iter 840: loss 1.4994, time 51.24ms, mfu 7.59%
iter 850: loss 1.4957, time 45.08ms, mfu 7.68%
iter 860: loss 1.4697, time 49.15ms, mfu 7.70%
iter 870: loss 1.5675, time 45.66ms, mfu 7.78%
iter 880: loss 1.4533, time 49.08ms, mfu 7.79%
iter 890: loss 1.5323, time 47.13ms, mfu 7.83%
iter 900: loss 1.4827, time 52.36ms, mfu 7.78%
iter 910: loss 1.6016, time 51.81ms, mfu 7.75%
iter 920: loss 1.5244, time 46.58ms, mfu 7.80%
iter 930: loss 1.5343, time 44.87ms, mfu 7.88%
iter 940: loss 1.3990, time 53.00ms, mfu 7.82%
iter 950: loss 1.5435, time 51.00ms, mfu 7.80%
iter 960: loss 1.5472, time 41.87ms, mfu 7.94%
iter 970: loss 1.4685, time 51.17ms, mfu 7.90%
iter 980: loss 1.5210, time 42.23ms, mfu 8.03%
iter 990: loss 1.5038, time 44.21ms, mfu 8.10%
step 1000: train loss 1.4404, val loss 1.6432
saving checkpoint to perliment_out2
iter 1000: loss 1.5130, time 5914.73ms, mfu 7.29%
iter 1010: loss 1.4612, time 47.12ms, mfu 7.38%
iter 1020: loss 1.5146, time 52.44ms, mfu 7.38%
iter 1030: loss 1.4736, time 53.69ms, mfu 7.36%
iter 1040: loss 1.4808, time 53.06ms, mfu 7.36%
iter 1050: loss 1.4992, time 49.39ms, mfu 7.40%
iter 1060: loss 1.5177, time 43.29ms, mfu 7.55%
iter 1070: loss 1.4179, time 47.58ms, mfu 7.61%
iter 1080: loss 1.4565, time 46.37ms, mfu 7.68%
iter 1090: loss 1.5305, time 48.24ms, mfu 7.71%
iter 1100: loss 1.4958, time 48.30ms, mfu 7.74%
iter 1110: loss 1.4627, time 52.63ms, mfu 7.70%
iter 1120: loss 1.4833, time 46.17ms, mfu 7.77%
iter 1130: loss 1.5157, time 39.83ms, mfu 7.96%
iter 1140: loss 1.4390, time 52.76ms, mfu 7.90%
iter 1150: loss 1.4573, time 53.79ms, mfu 7.83%
iter 1160: loss 1.4986, time 51.16ms, mfu 7.80%
iter 1170: loss 1.4690, time 47.46ms, mfu 7.83%
iter 1180: loss 1.4951, time 50.81ms, mfu 7.81%
iter 1190: loss 1.4272, time 48.48ms, mfu 7.82%
iter 1200: loss 1.4254, time 50.59ms, mfu 7.81%
iter 1210: loss 1.4209, time 45.27ms, mfu 7.88%
iter 1220: loss 1.4981, time 49.32ms, mfu 7.87%
iter 1230: loss 1.4416, time 54.24ms, mfu 7.80%
iter 1240: loss 1.3543, time 53.46ms, mfu 7.74%
step 1250: train loss 1.4155, val loss 1.6029
saving checkpoint to perliment_out2
iter 1250: loss 1.4362, time 5937.92ms, mfu 6.97%
iter 1260: loss 1.3343, time 52.78ms, mfu 7.01%
iter 1270: loss 1.4688, time 48.19ms, mfu 7.11%
iter 1280: loss 1.4259, time 46.64ms, mfu 7.23%
iter 1290: loss 1.4036, time 41.70ms, mfu 7.43%
iter 1300: loss 1.4661, time 50.71ms, mfu 7.45%
iter 1310: loss 1.5741, time 50.48ms, mfu 7.47%
iter 1320: loss 1.3563, time 48.58ms, mfu 7.52%
iter 1330: loss 1.4928, time 47.95ms, mfu 7.57%
iter 1340: loss 1.4611, time 51.02ms, mfu 7.57%
iter 1350: loss 1.2957, time 52.26ms, mfu 7.55%
iter 1360: loss 1.3333, time 54.05ms, mfu 7.51%
iter 1370: loss 1.4509, time 49.52ms, mfu 7.54%
iter 1380: loss 1.3075, time 53.34ms, mfu 7.51%
iter 1390: loss 1.3919, time 45.51ms, mfu 7.61%
iter 1400: loss 1.3549, time 46.65ms, mfu 7.68%
iter 1410: loss 1.4077, time 50.89ms, mfu 7.67%
iter 1420: loss 1.5073, time 49.78ms, mfu 7.68%
iter 1430: loss 1.3700, time 53.97ms, mfu 7.62%
iter 1440: loss 1.4110, time 48.48ms, mfu 7.66%
iter 1450: loss 1.4940, time 47.91ms, mfu 7.70%
iter 1460: loss 1.4010, time 49.19ms, mfu 7.71%
iter 1470: loss 1.5082, time 52.00ms, mfu 7.69%
iter 1480: loss 1.4057, time 46.78ms, mfu 7.74%
iter 1490: loss 1.4714, time 50.40ms, mfu 7.73%
step 1500: train loss 1.3752, val loss 1.5582
saving checkpoint to perliment_out2
iter 1500: loss 1.4158, time 5910.58ms, mfu 6.97%
iter 1510: loss 1.4478, time 46.14ms, mfu 7.11%
iter 1520: loss 1.3844, time 44.97ms, mfu 7.26%
iter 1530: loss 1.4256, time 48.17ms, mfu 7.33%
iter 1540: loss 1.4501, time 49.58ms, mfu 7.38%
iter 1550: loss 1.3929, time 47.54ms, mfu 7.45%
iter 1560: loss 1.4411, time 48.34ms, mfu 7.51%
iter 1570: loss 1.4223, time 51.08ms, mfu 7.51%
iter 1580: loss 1.3516, time 48.38ms, mfu 7.56%
iter 1590: loss 1.4002, time 51.77ms, mfu 7.55%
iter 1600: loss 1.4510, time 52.20ms, mfu 7.53%
iter 1610: loss 1.3919, time 52.45ms, mfu 7.52%
iter 1620: loss 1.4240, time 41.13ms, mfu 7.70%
iter 1630: loss 1.2921, time 45.81ms, mfu 7.78%
iter 1640: loss 1.4050, time 45.39ms, mfu 7.85%
iter 1650: loss 1.4095, time 50.85ms, mfu 7.82%
iter 1660: loss 1.4538, time 53.20ms, mfu 7.77%
iter 1670: loss 1.5365, time 49.02ms, mfu 7.78%
iter 1680: loss 1.3381, time 49.10ms, mfu 7.79%
iter 1690: loss 1.4279, time 47.16ms, mfu 7.83%
iter 1700: loss 1.4498, time 47.38ms, mfu 7.86%
iter 1710: loss 1.4253, time 48.20ms, mfu 7.88%
iter 1720: loss 1.4704, time 51.01ms, mfu 7.85%
iter 1730: loss 1.2761, time 46.37ms, mfu 7.89%
iter 1740: loss 1.3865, time 39.94ms, mfu 8.07%
step 1750: train loss 1.3571, val loss 1.5391
saving checkpoint to perliment_out2
iter 1750: loss 1.4437, time 5855.28ms, mfu 7.27%
iter 1760: loss 1.4674, time 51.46ms, mfu 7.29%
iter 1770: loss 1.4349, time 51.68ms, mfu 7.31%
iter 1780: loss 1.3112, time 53.18ms, mfu 7.31%
iter 1790: loss 1.4124, time 51.48ms, mfu 7.33%
iter 1800: loss 1.3720, time 51.66ms, mfu 7.34%
iter 1810: loss 1.4532, time 48.97ms, mfu 7.40%
iter 1820: loss 1.3946, time 45.89ms, mfu 7.50%
iter 1830: loss 1.4581, time 40.18ms, mfu 7.71%
iter 1840: loss 1.3705, time 49.61ms, mfu 7.72%
iter 1850: loss 1.4974, time 42.95ms, mfu 7.84%
iter 1860: loss 1.4313, time 49.64ms, mfu 7.84%
iter 1870: loss 1.3294, time 48.62ms, mfu 7.85%
iter 1880: loss 1.3857, time 55.30ms, mfu 7.76%
iter 1890: loss 1.3247, time 50.93ms, mfu 7.74%
iter 1900: loss 1.4170, time 51.74ms, mfu 7.72%
iter 1910: loss 1.3500, time 51.17ms, mfu 7.70%
iter 1920: loss 1.3693, time 46.18ms, mfu 7.77%
iter 1930: loss 1.3934, time 41.98ms, mfu 7.91%
iter 1940: loss 1.4493, time 48.19ms, mfu 7.92%
iter 1950: loss 1.4928, time 46.79ms, mfu 7.95%
iter 1960: loss 1.3280, time 48.29ms, mfu 7.96%
iter 1970: loss 1.4267, time 48.25ms, mfu 7.96%
iter 1980: loss 1.3525, time 50.27ms, mfu 7.93%
iter 1990: loss 1.4323, time 49.93ms, mfu 7.91%
Traceback (most recent call last):
  File "train.py", line 261, in <module>
    losses = estimate_loss()
  File "/global/home/users/njo/anaconda3/envs/gaia/lib/python3.8/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "train.py", line 221, in estimate_loss
    logits, loss = model(X, Y)
  File "/global/home/users/njo/anaconda3/envs/gaia/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/global/home/users/njo/anaconda3/envs/gaia/lib/python3.8/site-packages/torch/_dynamo/eval_frame.py", line 82, in forward
    return self.dynamo_ctx(self._orig_mod.forward)(*args, **kwargs)
  File "/global/home/users/njo/anaconda3/envs/gaia/lib/python3.8/site-packages/torch/_dynamo/eval_frame.py", line 209, in _fn
    return fn(*args, **kwargs)
  File "/global/home/users/njo/nanoGPT/model.py", line 208, in forward
    x = block(x)
  File "/global/home/users/njo/anaconda3/envs/gaia/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/global/home/users/njo/nanoGPT/model.py", line 130, in forward
    def forward(self, x):
  File "/global/home/users/njo/anaconda3/envs/gaia/lib/python3.8/site-packages/torch/_dynamo/eval_frame.py", line 209, in _fn
    return fn(*args, **kwargs)
  File "/global/home/users/njo/anaconda3/envs/gaia/lib/python3.8/site-packages/torch/_functorch/aot_autograd.py", line 2836, in forward
    return compiled_fn(full_args)
  File "/global/home/users/njo/anaconda3/envs/gaia/lib/python3.8/site-packages/torch/_functorch/aot_autograd.py", line 1224, in g
    return f(*args)
  File "/global/home/users/njo/anaconda3/envs/gaia/lib/python3.8/site-packages/torch/_functorch/aot_autograd.py", line 1900, in runtime_wrapper
    all_outs = call_func_with_args(
  File "/global/home/users/njo/anaconda3/envs/gaia/lib/python3.8/site-packages/torch/_functorch/aot_autograd.py", line 1249, in call_func_with_args
    out = normalize_as_list(f(args))
  File "/global/home/users/njo/anaconda3/envs/gaia/lib/python3.8/site-packages/torch/_inductor/compile_fx.py", line 248, in run
    return model(new_inputs)
  File "/tmp/torchinductor_njo/dt/cdtfd6drduq5qgzuwac7shzh2ikmx56ai7secrwkt7zrdaeoqkj2.py", line 289, in call
    triton__0.run(buf1, arg6_1, arg0_1, buf3, 16384, 384, grid=grid(16384), stream=stream0)
  File "/global/home/users/njo/anaconda3/envs/gaia/lib/python3.8/site-packages/torch/_inductor/triton_ops/autotune.py", line 190, in run
    result = launcher(
  File "<string>", line 6, in launcher
KeyboardInterrupt